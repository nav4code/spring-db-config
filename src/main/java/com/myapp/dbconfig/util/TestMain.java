package com.myapp.dbconfig.util;

import java.io.ByteArrayInputStream;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;

import org.apache.commons.codec.binary.Base64;
import org.apache.http.impl.conn.PoolingHttpClientConnectionManager;
import org.joda.time.Instant;
import org.opensaml.Configuration;
import org.opensaml.DefaultBootstrap;
import org.opensaml.common.SignableSAMLObject;
import org.opensaml.saml2.core.Attribute;
import org.opensaml.saml2.core.AttributeStatement;
import org.opensaml.saml2.core.Response;
import org.opensaml.xml.ConfigurationException;
import org.opensaml.xml.XMLObject;
import org.opensaml.xml.io.Unmarshaller;
import org.w3c.dom.Document;
import org.w3c.dom.Element;

public class TestMain {
	public static void main(String[]  args) throws ConfigurationException {
		DefaultBootstrap.bootstrap();
		String samlResponse = "PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c2FtbDJwOlJlc3BvbnNlIHhtbG5zOnNhbWwycD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnByb3RvY29sIiBEZXN0aW5hdGlvbj0iaHR0cDovL2xvY2FsaG9zdDo4MTExL2NvbWVpbiIgSUQ9ImlkMjEwOTQyMjgyMjAwNjQ0MDE2MDA0MDQyNDMiIElzc3VlSW5zdGFudD0iMjAxNi0wMi0yN1QwNjoxMToyMC40NjNaIiBWZXJzaW9uPSIyLjAiIHhtbG5zOnhzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYSI+PHNhbWwyOklzc3VlciB4bWxuczpzYW1sMj0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiPmh0dHA6Ly93d3cub2t0YS5jb20vZXhrNXF1Z3QxbjBJZmYyVzIwaDc8L3NhbWwyOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6U2lnbmVkSW5mbz48ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8+PGRzOlJlZmVyZW5jZSBVUkk9IiNpZDIxMDk0MjI4MjIwMDY0NDAxNjAwNDA0MjQzIj48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnI2VudmVsb3BlZC1zaWduYXR1cmUiLz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIj48ZWM6SW5jbHVzaXZlTmFtZXNwYWNlcyB4bWxuczplYz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIiBQcmVmaXhMaXN0PSJ4cyIvPjwvZHM6VHJhbnNmb3JtPjwvZHM6VHJhbnNmb3Jtcz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2Ii8+PGRzOkRpZ2VzdFZhbHVlPjd5NlhRNHJqc2xYMm1RZHBZbWtRaXpubjBPY2FYQ3lodjRZK3Z2a3dXSFE9PC9kczpEaWdlc3RWYWx1ZT48L2RzOlJlZmVyZW5jZT48L2RzOlNpZ25lZEluZm8+PGRzOlNpZ25hdHVyZVZhbHVlPkVRYjA1bUhobFBESUN0WE10MVpGMFR6QmNYV1FBUzNicTNOMEVjUURpaDlETEN4OGVwQjdJUVlPbnlZYVhNcmhLV3FtTm9VMUVaalJhVC9UQmxsL2Yyd0RCdERNelBvb2F3VGRSVDRsTU1ERnFpcno1NTVMa0dLUjJ4SGd1dW5ZcU5nV0VlVi9hTDVQMFVxc3BvbU9sS25mOVhyL1ZhemdEOEQ1K21NQ1grS1BJbDFidmtlOHNMRW92aHFPVG5QT2hxaHd4TWppNmVTSEN6QzBrZWdpQ0YySkN3allPYk9XbjliNlFFb3Q5L2wwU0NRbXVWZWkzT1AzQnF3WkVPT2pGY3R1RVdscWJ2NXFUdmtWcnMvNkxuNmR2eEFCWU9pUDJTNXFGQTEwMFNSc2wyRDFiSVpTeGE0NkNxMFhYNzZ3YUdQYmpEREZaSzBwN3gwcFBKL1ZxUT09PC9kczpTaWduYXR1cmVWYWx1ZT48ZHM6S2V5SW5mbz48ZHM6WDUwOURhdGE+PGRzOlg1MDlDZXJ0aWZpY2F0ZT5NSUlEcERDQ0FveWdBd0lCQWdJR0FWSnFNYmI0TUEwR0NTcUdTSWIzRFFFQkJRVUFNSUdTTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHCkExVUVDQXdLUTJGc2FXWnZjbTVwWVRFV01CUUdBMVVFQnd3TlUyRnVJRVp5WVc1amFYTmpiekVOTUFzR0ExVUVDZ3dFVDJ0MFlURVUKTUJJR0ExVUVDd3dMVTFOUFVISnZkbWxrWlhJeEV6QVJCZ05WQkFNTUNtUmxkaTA0TnpZM09UQXhIREFhQmdrcWhraUc5dzBCQ1FFVwpEV2x1Wm05QWIydDBZUzVqYjIwd0hoY05NVFl3TVRJeU1UWXpOVEk1V2hjTk1qWXdNVEl5TVRZek5qSTVXakNCa2pFTE1Ba0dBMVVFCkJoTUNWVk14RXpBUkJnTlZCQWdNQ2tOaGJHbG1iM0p1YVdFeEZqQVVCZ05WQkFjTURWTmhiaUJHY21GdVkybHpZMjh4RFRBTEJnTlYKQkFvTUJFOXJkR0V4RkRBU0JnTlZCQXNNQzFOVFQxQnliM1pwWkdWeU1STXdFUVlEVlFRRERBcGtaWFl0T0RjMk56a3dNUnd3R2dZSgpLb1pJaHZjTkFRa0JGZzFwYm1adlFHOXJkR0V1WTI5dE1JSUJJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBCnF2eXhMR20vUGFjTS85a1Z3Ulk3L05NL0xYN0VwTlR1Yy95LzZMN3RqY1BCVkFYMnRBMGNraTVFeTVCSEdkVm02SDl3RlF3YUxyQ3AKVCsvV3lSSXdIbjNRMmZnTGdXbG1GRU9GTHlicCtrQXluZTBMekJJUXFlUTdzaEUzSUU2aWpmQ29lTVA4TDc2NEZURERwZnkwNFc2ZQo1RVBFRjFOL3ZkUXZwNThzV1FsTmN6OUJPMEw1MGxaNmNRQk5XSldpTHFUNFJhcXE5bGZZb2dJS1puaVQ3WFJ3QUJYd2lQem5WYVcwCmFZUnVQSjdXaGFJcVhTUUhvRDNXTWp4cmUvdWRFVWY5VG9LRjNMVjdWeU1hR0g4S2tIZTBZdUJMTE5oY29ydDBqTjN1QVFyVEM1ZGEKVVlSbFRuWFk4N1piTURZdWx2ekdCKzJ1bzdUanZFeVBzV3FaTHdJREFRQUJNQTBHQ1NxR1NJYjNEUUVCQlFVQUE0SUJBUUNmRi9ZdgpZMld4amlNaEFlY1M3OHhVVzZUd1JaKzZuclQ4SnJzK2p1b3lUWGliWkV5MUpHd09FTXloQWluaHcxa083azZQMjY3aCtPR213YmJwCk1IMWIrbkFtMHF6TE1pdWJnQnJWWUpaK3YzL0puL2c5TU1IcnN0dk1UYk05eVdneFJBL3JOV1BpTGREcDZkRVk0b2ptQlJJVnRiTlcKNS9JVG9vZjkyOVZady8xVDUva1BUdXc0OU1iYytKTFhjT3hkc2hsazR5eCthWTJNcHV4bHhQb2xZWG5STVNLZGNQOUVxbTA0VXE3dQoySG5lVkN4YzlHeC9MK0pOck9iYXBxWUpFTmZndStmUFpPYXdPalp2aTM2aUZXTEtzcmhYRDkyUmN2SElYa1lrMWV1c0xYRURHd0VnCmtXMTIzN0FjQ25iNWpRMmhIVVJ4VGxSVjR5NmFSeVZaPC9kczpYNTA5Q2VydGlmaWNhdGU+PC9kczpYNTA5RGF0YT48L2RzOktleUluZm8+PC9kczpTaWduYXR1cmU+PHNhbWwycDpTdGF0dXMgeG1sbnM6c2FtbDJwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiPjxzYW1sMnA6U3RhdHVzQ29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1czpTdWNjZXNzIi8+PC9zYW1sMnA6U3RhdHVzPjxzYW1sMjpBc3NlcnRpb24geG1sbnM6c2FtbDI9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIElEPSJpZDIxMDk0MjI4MjIwOTIzMzIxNzEyOTkyNzMxIiBJc3N1ZUluc3RhbnQ9IjIwMTYtMDItMjdUMDY6MTE6MjAuNDYzWiIgVmVyc2lvbj0iMi4wIiB4bWxuczp4cz0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEiPjxzYW1sMjpJc3N1ZXIgRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6bmFtZWlkLWZvcm1hdDplbnRpdHkiIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj5odHRwOi8vd3d3Lm9rdGEuY29tL2V4azVxdWd0MW4wSWZmMlcyMGg3PC9zYW1sMjpJc3N1ZXI+PGRzOlNpZ25hdHVyZSB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC8wOS94bWxkc2lnIyI+PGRzOlNpZ25lZEluZm8+PGRzOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48ZHM6U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjcnNhLXNoYTI1NiIvPjxkczpSZWZlcmVuY2UgVVJJPSIjaWQyMTA5NDIyODIyMDkyMzMyMTcxMjk5MjczMSI+PGRzOlRyYW5zZm9ybXM+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2lnbmF0dXJlIi8+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyI+PGVjOkluY2x1c2l2ZU5hbWVzcGFjZXMgeG1sbnM6ZWM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIgUHJlZml4TGlzdD0ieHMiLz48L2RzOlRyYW5zZm9ybT48L2RzOlRyYW5zZm9ybXM+PGRzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPjxkczpEaWdlc3RWYWx1ZT51ZjRFTk5Ray83eEtJMERoK0IrZnRyaDdiRHBMcmZ3a2xubHZtL2VvbnBrPTwvZHM6RGlnZXN0VmFsdWU+PC9kczpSZWZlcmVuY2U+PC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1ZT5FNzNjdkdSbi9yL1RPRzZPVFN3M2RVNmdVQzhFUmJVZFEwQlEvK1RVSjBWb2hrYzNBZ0xjRHV3WCtia09hSnVIMmJOQThKUmtSN2h0YXhwWnZIc2FVZ2gzeGsrQkp2ZTN0SFZyWEVjeGF4Q3k3b2w2Y1hjRlFyYU5tRkRoaW8zVk5PNVZRWGFxQm5ndUlKbHBZSEhaT3RhSS8rR05DUDlCbXR6b2hVSEorR1V0MDZ0Smo5ZGdVRmpDOXBVbkFBM1V2aHR4ZkFpTVdlU2hzYnF1WkIzK2tleUR4dXYvYlQyQ3p5VVZMSkJ4MDl3WXJTVXo4MERidE9Pb1pUKzFnV1N1WE03ZWtWanE4QzRWTmMzS3RQdUo4bkNYZGo1d09oMVpLYmZhY3NQRHBZTitHemRtaHB1ZityRWdVZ3g1T3Q0Wk9mQURTWCtLWU93K01zQktCeEdPRUE9PTwvZHM6U2lnbmF0dXJlVmFsdWU+PGRzOktleUluZm8+PGRzOlg1MDlEYXRhPjxkczpYNTA5Q2VydGlmaWNhdGU+TUlJRHBEQ0NBb3lnQXdJQkFnSUdBVkpxTWJiNE1BMEdDU3FHU0liM0RRRUJCUVVBTUlHU01Rc3dDUVlEVlFRR0V3SlZVekVUTUJFRwpBMVVFQ0F3S1EyRnNhV1p2Y201cFlURVdNQlFHQTFVRUJ3d05VMkZ1SUVaeVlXNWphWE5qYnpFTk1Bc0dBMVVFQ2d3RVQydDBZVEVVCk1CSUdBMVVFQ3d3TFUxTlBVSEp2ZG1sa1pYSXhFekFSQmdOVkJBTU1DbVJsZGkwNE56WTNPVEF4SERBYUJna3Foa2lHOXcwQkNRRVcKRFdsdVptOUFiMnQwWVM1amIyMHdIaGNOTVRZd01USXlNVFl6TlRJNVdoY05Nall3TVRJeU1UWXpOakk1V2pDQmtqRUxNQWtHQTFVRQpCaE1DVlZNeEV6QVJCZ05WQkFnTUNrTmhiR2xtYjNKdWFXRXhGakFVQmdOVkJBY01EVk5oYmlCR2NtRnVZMmx6WTI4eERUQUxCZ05WCkJBb01CRTlyZEdFeEZEQVNCZ05WQkFzTUMxTlRUMUJ5YjNacFpHVnlNUk13RVFZRFZRUUREQXBrWlhZdE9EYzJOemt3TVJ3d0dnWUoKS29aSWh2Y05BUWtCRmcxcGJtWnZRRzlyZEdFdVkyOXRNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQQpxdnl4TEdtL1BhY00vOWtWd1JZNy9OTS9MWDdFcE5UdWMveS82TDd0amNQQlZBWDJ0QTBja2k1RXk1QkhHZFZtNkg5d0ZRd2FMckNwClQrL1d5Ukl3SG4zUTJmZ0xnV2xtRkVPRkx5YnAra0F5bmUwTHpCSVFxZVE3c2hFM0lFNmlqZkNvZU1QOEw3NjRGVEREcGZ5MDRXNmUKNUVQRUYxTi92ZFF2cDU4c1dRbE5jejlCTzBMNTBsWjZjUUJOV0pXaUxxVDRSYXFxOWxmWW9nSUtabmlUN1hSd0FCWHdpUHpuVmFXMAphWVJ1UEo3V2hhSXFYU1FIb0QzV01qeHJlL3VkRVVmOVRvS0YzTFY3VnlNYUdIOEtrSGUwWXVCTExOaGNvcnQwak4zdUFRclRDNWRhClVZUmxUblhZODdaYk1EWXVsdnpHQisydW83VGp2RXlQc1dxWkx3SURBUUFCTUEwR0NTcUdTSWIzRFFFQkJRVUFBNElCQVFDZkYvWXYKWTJXeGppTWhBZWNTNzh4VVc2VHdSWis2bnJUOEpycytqdW95VFhpYlpFeTFKR3dPRU15aEFpbmh3MWtPN2s2UDI2N2grT0dtd2JicApNSDFiK25BbTBxekxNaXViZ0JyVllKWit2My9Kbi9nOU1NSHJzdHZNVGJNOXlXZ3hSQS9yTldQaUxkRHA2ZEVZNG9qbUJSSVZ0Yk5XCjUvSVRvb2Y5MjlWWncvMVQ1L2tQVHV3NDlNYmMrSkxYY094ZHNobGs0eXgrYVkyTXB1eGx4UG9sWVhuUk1TS2RjUDlFcW0wNFVxN3UKMkhuZVZDeGM5R3gvTCtKTnJPYmFwcVlKRU5mZ3UrZlBaT2F3T2padmkzNmlGV0xLc3JoWEQ5MlJjdkhJWGtZazFldXNMWEVER3dFZwprVzEyMzdBY0NuYjVqUTJoSFVSeFRsUlY0eTZhUnlWWjwvZHM6WDUwOUNlcnRpZmljYXRlPjwvZHM6WDUwOURhdGE+PC9kczpLZXlJbmZvPjwvZHM6U2lnbmF0dXJlPjxzYW1sMjpTdWJqZWN0IHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj48c2FtbDI6TmFtZUlEIEZvcm1hdD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6MS4xOm5hbWVpZC1mb3JtYXQ6ZW1haWxBZGRyZXNzIj52aXZlay52YXJkaGFuQHRoaW5rYXJ0aGEuY29tPC9zYW1sMjpOYW1lSUQ+PHNhbWwyOlN1YmplY3RDb25maXJtYXRpb24gTWV0aG9kPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y206YmVhcmVyIj48c2FtbDI6U3ViamVjdENvbmZpcm1hdGlvbkRhdGEgTm90T25PckFmdGVyPSIyMDE2LTAyLTI3VDA2OjE2OjIwLjQ2M1oiIFJlY2lwaWVudD0iaHR0cDovL2xvY2FsaG9zdDo4MTExL2NvbWVpbiIvPjwvc2FtbDI6U3ViamVjdENvbmZpcm1hdGlvbj48L3NhbWwyOlN1YmplY3Q+PHNhbWwyOkNvbmRpdGlvbnMgTm90QmVmb3JlPSIyMDE2LTAyLTI3VDA2OjA2OjIwLjQ2M1oiIE5vdE9uT3JBZnRlcj0iMjAxNi0wMi0yN1QwNjoxNjoyMC40NjNaIiB4bWxuczpzYW1sMj0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI+PHNhbWwyOkF1ZGllbmNlUmVzdHJpY3Rpb24+PHNhbWwyOkF1ZGllbmNlPmh0dHA6Ly9sb2NhbGhvc3Q6ODExMTwvc2FtbDI6QXVkaWVuY2U+PC9zYW1sMjpBdWRpZW5jZVJlc3RyaWN0aW9uPjwvc2FtbDI6Q29uZGl0aW9ucz48c2FtbDI6QXV0aG5TdGF0ZW1lbnQgQXV0aG5JbnN0YW50PSIyMDE2LTAyLTI3VDA2OjExOjIwLjQ2M1oiIFNlc3Npb25JbmRleD0iaWQxNDU2NTUzNDgwNDYzLjE1MjY5OTk0OTciIHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj48c2FtbDI6QXV0aG5Db250ZXh0PjxzYW1sMjpBdXRobkNvbnRleHRDbGFzc1JlZj51cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydDwvc2FtbDI6QXV0aG5Db250ZXh0Q2xhc3NSZWY+PC9zYW1sMjpBdXRobkNvbnRleHQ+PC9zYW1sMjpBdXRoblN0YXRlbWVudD48c2FtbDI6QXR0cmlidXRlU3RhdGVtZW50IHhtbG5zOnNhbWwyPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXNzZXJ0aW9uIj48c2FtbDI6QXR0cmlidXRlIE5hbWU9InVzZXJuYW1lIiBOYW1lRm9ybWF0PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YXR0cm5hbWUtZm9ybWF0OmJhc2ljIj48c2FtbDI6QXR0cmlidXRlVmFsdWUgeG1sbnM6eHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hIiB4bWxuczp4c2k9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvWE1MU2NoZW1hLWluc3RhbmNlIiB4c2k6dHlwZT0ieHM6c3RyaW5nIj5hZG1pbjwvc2FtbDI6QXR0cmlidXRlVmFsdWU+PC9zYW1sMjpBdHRyaWJ1dGU+PC9zYW1sMjpBdHRyaWJ1dGVTdGF0ZW1lbnQ+PC9zYW1sMjpBc3NlcnRpb24+PC9zYW1sMnA6UmVzcG9uc2U+";
		Map<String,String> claims = getInfo(samlResponse);
	}
	
	private static  Map<String,String> getInfo(String responseMessage)  {
		try {
			
			byte[] base64DecodedResponse = new Base64().decode(responseMessage);
			ByteArrayInputStream is = new ByteArrayInputStream(base64DecodedResponse);
	
			DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();
			documentBuilderFactory.setNamespaceAware(true);
			DocumentBuilder docBuilder = documentBuilderFactory.newDocumentBuilder();
			Document document = docBuilder.parse(is);
			Element element = document.getDocumentElement();
			Unmarshaller unmarshaller = Configuration.getUnmarshallerFactory()
					.getUnmarshaller(document.getDocumentElement());
			XMLObject responseXmlObj = unmarshaller.unmarshall(element);
			Response response = (Response) responseXmlObj;
			System.out.println(response.getVersion());
			SignableSAMLObject samlToken = (SignableSAMLObject) response
					.getAssertions().get(0);

			Instant notBefore = ((org.opensaml.saml2.core.Assertion) samlToken)
					.getConditions().getNotBefore().toInstant();
			Instant notOnOrAfter = ((org.opensaml.saml2.core.Assertion) samlToken)
					.getConditions().getNotOnOrAfter().toInstant();
			
			Map<String,String> claims = isAttributeStatementPresent(samlToken);
			System.out.println(claims.size());
			for(Map.Entry<String, String> e : claims.entrySet() ) {
				System.out.println(e.getKey() + e.getValue());
			}
			return claims;
			
		} catch(Exception e) {
			e.printStackTrace();
		}
		return null;
	}
	
	public static Map<String, String> isAttributeStatementPresent(
			SignableSAMLObject samlToken) {
		//logger.info("Attribute Values are : ");
		Map<String, String> claims = new HashMap<String, String>();
		try {
			List<AttributeStatement> attributeStatements = ((org.opensaml.saml2.core.Assertion) samlToken)
					.getAttributeStatements();
			for (AttributeStatement attrStatement : attributeStatements) {
				List<Attribute> attributes = attrStatement.getAttributes();
				for (Attribute attribute : attributes) {
					StringBuffer atts = new StringBuffer();
					for (XMLObject xml : attribute.getAttributeValues()) {
						if(atts.length() > 0){
							atts.append(",");
						}
						atts.append(xml.getDOM().getTextContent());
					}
					claims.put(attribute.getName(),atts.toString());

				}
			}
		} catch (Exception e) {
			e.printStackTrace();

		}
		return claims;
	}
	
}
